%h1 トップページ
- if user_signed_in?
  %h2 ログインしています
  
  = link_to "ログアウト", destroy_user_session_path, method: :delete
- else
  %h2 ログインしていません
  = link_to "新規登録", new_user_registration_path
  = link_to "ログイン", new_user_session_path


= link_to "マイページ",  new_credit_path
  
  
!!!
%html
  %head
    %meta{:content => "text/html; charset=UTF-8", "http-equiv" => "Content-Type"}/
    %meta{:charset => "utf-8"}/
    %meta{:content => "width=device-width,initial-scale=1.0", :name => "viewport"}/
    %title
    %script{:src => "https://js.pay.jp/", :type => "text/javascript"}
    %link{:charset => "utf-8", :href => "//oss.maxcdn.com/semantic-ui/2.0.7/semantic.min.css", :media => "screen", :rel => "stylesheet", :type => "text/css"}/
    %link{:charset => "utf-8", :href => "https://raw.githubusercontent.com/daneden/animate.css/master/animate.min.css", :media => "screen", :rel => "stylesheet", :title => "no title"}/
    %style{:media => "screen"}
      :cdata
        section {
        margin: 15px;
        max-width: 960px;
        }
  %body
    %section
      %form.ui.form
        %h4.ui.dividing.header 支払い
        .field
          %label カード番号
          %input{:maxlength => "16", :name => "number", :placeholder => "Card #", :type => "text"}/
        .fields
          .six.wide.field
            %label CVC
            %input{:maxlength => "4", :name => "cvc", :placeholder => "CVC", :type => "text"}/
          .ten.wide.field
            %label 有効期限
            .two.fields
              .field
                %select.ui.fluid.search.dropdown{:name => "exp_month"}
                  %option{:value => ""} 月
                  %option{:value => "1"} 01
                  %option{:value => "2"} 02
                  %option{:value => "3"} 03
                  %option{:value => "4"} 04
                  %option{:value => "5"} 05
                  %option{:value => "6"} 06
                  %option{:value => "7"} 07
                  %option{:value => "8"} 08
                  %option{:value => "9"} 09
                  %option{:value => "10"} 10
                  %option{:value => "11"} 11
                  %option{:value => "12"} 12
              .field
                %input{:maxlength => "4", :name => "exp_year", :placeholder => "年", :type => "text"}/
        %button.ui.button.fill{:tabindex => "0"}
          サンプルのカード番号を使う
        %button.ui.primary.button.submit
          送信
        %p#result
    :javascript
      (function() {

        var number = document.querySelector('input[name="number"]'),
            cvc = document.querySelector('input[name="cvc"]'),
            exp_month = document.querySelector('select[name="exp_month"]'),
            exp_year = document.querySelector('input[name="exp_year"]')
        ;

        document.querySelector('.fill').addEventListener('click', function(e) {
          e.preventDefault();
          number.value = '4242424242424242';
          cvc.value = '123';
          exp_month.value = '12';
          exp_year.value = '2020';
        });

        document.querySelector('.submit').addEventListener('click', function(e) {
          e.preventDefault();

          Payjp.setPublicKey('pk_test_43e2e13c79bc27b1ce6ee5f3');

          var card = {
            number: number.value,
            cvc: cvc.value,
            exp_month: exp_month.value,
            exp_year: exp_year.value
          }

          Payjp.createToken(card, function(s, response) {
            document.getElementById('result').innerText = 'Token = ' + response.id;
          });
        });

      })();